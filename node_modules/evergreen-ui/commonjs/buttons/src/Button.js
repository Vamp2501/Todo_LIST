"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _typeof = require("@babel/runtime/helpers/typeof");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.getIconSizeForButton = exports.pseudoSelectors = exports.internalStyles = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _uiBox = _interopRequireWildcard(require("ui-box"));

var _hooks = require("../../hooks");

var _IconWrapper = require("../../icons/src/IconWrapper");

var _deprecatedThemeHelpers = require("../../lib/deprecated-theme-helpers");

var _spinner = require("../../spinner");

var _excluded = ["appearance", "children", "className", "color", "disabled", "iconAfter", "iconBefore", "intent", "is", "isActive", "isLoading"],
    _excluded2 = ["className"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

/* eslint-disable react/prop-types */
var ButtonIcon = /*#__PURE__*/(0, _react.memo)(function ButtonIcon(_ref) {
  var edge = _ref.edge,
      icon = _ref.icon,
      size = _ref.size,
      spacing = _ref.spacing;
  if (!icon) return null;
  var relativeSpace = typeof spacing === 'number' ? spacing : size;
  var edgeMargin = -Math.round(relativeSpace * 0.25);
  var innerMargin = Math.round(size * 0.7);
  var marginLeft = edge === 'start' ? edgeMargin : innerMargin;
  var marginRight = edge === 'end' ? edgeMargin : innerMargin;
  return /*#__PURE__*/_react["default"].createElement(_IconWrapper.IconWrapper, {
    icon: icon,
    size: size,
    marginLeft: marginLeft,
    marginRight: marginRight
  });
});
/* eslint-enable react/prop-types */

var internalStyles = {
  position: 'relative',
  fontWeight: 500,
  display: 'inline-flex',
  alignItems: 'center',
  flexWrap: 'nowrap',
  justifyContent: 'center',
  textDecoration: 'none',
  verticalAlign: 'middle',
  border: 'none',
  outline: 'none',
  userSelect: 'none',
  cursor: 'pointer',
  whiteSpace: 'nowrap',
  WebkitFontSmoothing: 'antialiased',
  WebkitAppearance: 'none',
  MozAppearance: 'none',
  '&::-moz-focus-inner ': {
    border: 0
  }
};
exports.internalStyles = internalStyles;
var pseudoSelectors = {
  _active: '&:not([disabled]):active, &:not([disabled])[aria-expanded="true"], &:not([disabled])[data-active]',
  _disabled: '&[disabled]',
  _focus: '&:not([disabled]):focus',
  _focusAndActive: '&:not([disabled]):focus:active, &:not([disabled])[aria-expanded="true"]:focus, &:not([disabled])[data-active]:focus',
  _hover: '&:not([disabled]):hover'
};
exports.pseudoSelectors = pseudoSelectors;

var getIconSizeForButton = function getIconSizeForButton(height) {
  if (height <= 28) return 12;
  if (height <= 32) return 14;
  if (height <= 40) return 16;
  if (height <= 48) return 18;
  return 20;
};

exports.getIconSizeForButton = getIconSizeForButton;
var Button = /*#__PURE__*/(0, _react.memo)( /*#__PURE__*/(0, _react.forwardRef)(function Button(props, ref) {
  var _props$appearance = props.appearance,
      appearance = _props$appearance === void 0 ? 'default' : _props$appearance,
      children = props.children,
      className = props.className,
      color = props.color,
      disabled = props.disabled,
      iconAfter = props.iconAfter,
      iconBefore = props.iconBefore,
      _props$intent = props.intent,
      intent = _props$intent === void 0 ? 'none' : _props$intent,
      _props$is = props.is,
      is = _props$is === void 0 ? 'button' : _props$is,
      _props$isActive = props.isActive,
      isActive = _props$isActive === void 0 ? false : _props$isActive,
      isLoading = props.isLoading,
      restProps = (0, _objectWithoutProperties2["default"])(props, _excluded);

  var _useStyleConfig = (0, _hooks.useStyleConfig)('Button', {
    appearance: appearance,
    color: color,
    intent: intent,
    size: restProps.size || 'medium'
  }, pseudoSelectors, internalStyles),
      themedClassName = _useStyleConfig.className,
      boxProps = (0, _objectWithoutProperties2["default"])(_useStyleConfig, _excluded2);

  var height = restProps.height || boxProps.height; // Keep backwards compat font sizing if an explicit height was passed in.

  var textProps = !restProps.size && restProps.height ? (0, _deprecatedThemeHelpers.getTextPropsForControlHeight)(restProps.height) : {};
  var iconSize = getIconSizeForButton(height);
  return /*#__PURE__*/_react["default"].createElement(_uiBox["default"], (0, _extends2["default"])({
    is: is,
    ref: ref,
    className: (0, _classnames["default"])(themedClassName, className),
    "data-active": isActive || undefined
  }, boxProps, restProps, textProps, {
    disabled: disabled || isLoading
  }), isLoading && /*#__PURE__*/_react["default"].createElement(_spinner.Spinner, {
    marginLeft: -Math.round(height / 8),
    marginRight: Math.round(height / 4),
    size: Math.round(height / 2)
  }), /*#__PURE__*/_react["default"].createElement(ButtonIcon, {
    icon: iconBefore,
    size: iconSize,
    spacing: restProps.paddingLeft,
    edge: "start"
  }), children, /*#__PURE__*/_react["default"].createElement(ButtonIcon, {
    icon: iconAfter,
    size: iconSize,
    spacing: restProps.paddingRight,
    edge: "end"
  }));
}));
Button.propTypes = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, _uiBox.dimensions.propTypes), _uiBox.spacing.propTypes), _uiBox.position.propTypes), _uiBox.layout.propTypes), {}, {
  /**
   * The intent of the button.
   */
  intent: _propTypes["default"].string,

  /**
   * The appearance of the button.
   */
  appearance: _propTypes["default"].string,

  /**
   * The size of the button
   */
  size: _propTypes["default"].oneOf(['small', 'medium', 'large']),

  /**
   * When true, show a loading spinner before the children.
   * This also disables the button.
   */
  isLoading: _propTypes["default"].bool,

  /**
   * Forcefully set the active state of a button.
   * Useful in conjunction with a Popover.
   */
  isActive: _propTypes["default"].bool,

  /**
   * Sets an icon before the text. Can be any icon from Evergreen or a custom element.
   */
  iconBefore: _propTypes["default"].oneOfType([_propTypes["default"].elementType, _propTypes["default"].element]),

  /**
   * Sets an icon after the text. Can be any icon from Evergreen or a custom element.
   */
  iconAfter: _propTypes["default"].oneOfType([_propTypes["default"].elementType, _propTypes["default"].element]),

  /**
   * When true, the button is disabled.
   * isLoading also sets the button to disabled.
   */
  disabled: _propTypes["default"].bool,

  /**
   * Class name passed to the button.
   * Only use if you know what you are doing.
   */
  className: _propTypes["default"].string
});
var _default = Button;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9idXR0b25zL3NyYy9CdXR0b24uanMiXSwibmFtZXMiOlsiQnV0dG9uSWNvbiIsImVkZ2UiLCJpY29uIiwic2l6ZSIsInNwYWNpbmciLCJyZWxhdGl2ZVNwYWNlIiwiZWRnZU1hcmdpbiIsIk1hdGgiLCJyb3VuZCIsImlubmVyTWFyZ2luIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwiaW50ZXJuYWxTdHlsZXMiLCJwb3NpdGlvbiIsImZvbnRXZWlnaHQiLCJkaXNwbGF5IiwiYWxpZ25JdGVtcyIsImZsZXhXcmFwIiwianVzdGlmeUNvbnRlbnQiLCJ0ZXh0RGVjb3JhdGlvbiIsInZlcnRpY2FsQWxpZ24iLCJib3JkZXIiLCJvdXRsaW5lIiwidXNlclNlbGVjdCIsImN1cnNvciIsIndoaXRlU3BhY2UiLCJXZWJraXRGb250U21vb3RoaW5nIiwiV2Via2l0QXBwZWFyYW5jZSIsIk1vekFwcGVhcmFuY2UiLCJwc2V1ZG9TZWxlY3RvcnMiLCJfYWN0aXZlIiwiX2Rpc2FibGVkIiwiX2ZvY3VzIiwiX2ZvY3VzQW5kQWN0aXZlIiwiX2hvdmVyIiwiZ2V0SWNvblNpemVGb3JCdXR0b24iLCJoZWlnaHQiLCJCdXR0b24iLCJwcm9wcyIsInJlZiIsImFwcGVhcmFuY2UiLCJjaGlsZHJlbiIsImNsYXNzTmFtZSIsImNvbG9yIiwiZGlzYWJsZWQiLCJpY29uQWZ0ZXIiLCJpY29uQmVmb3JlIiwiaW50ZW50IiwiaXMiLCJpc0FjdGl2ZSIsImlzTG9hZGluZyIsInJlc3RQcm9wcyIsInRoZW1lZENsYXNzTmFtZSIsImJveFByb3BzIiwidGV4dFByb3BzIiwiaWNvblNpemUiLCJ1bmRlZmluZWQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsInByb3BUeXBlcyIsImRpbWVuc2lvbnMiLCJsYXlvdXQiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJvbmVPZiIsImJvb2wiLCJvbmVPZlR5cGUiLCJlbGVtZW50VHlwZSIsImVsZW1lbnQiXSwibWFw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YWN0J1xuaW1wb3J0IGN4IGZyb20gJ2NsYXNzbmFtZXMnXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgQm94LCB7IHNwYWNpbmcsIGRpbWVuc2lvbnMsIHBvc2l0aW9uLCBsYXlvdXQgfSBmcm9tICd1aS1ib3gnXG5pbXBvcnQgeyB1c2VTdHlsZUNvbmZpZyB9IGZyb20gJy4uLy4uL2hvb2tzJ1xuaW1wb3J0IHsgSWNvbldyYXBwZXIgfSBmcm9tICcuLi8uLi9pY29ucy9zcmMvSWNvbldyYXBwZXInXG5pbXBvcnQgeyBnZXRUZXh0UHJvcHNGb3JDb250cm9sSGVpZ2h0IH0gZnJvbSAnLi4vLi4vbGliL2RlcHJlY2F0ZWQtdGhlbWUtaGVscGVycydcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi8uLi9zcGlubmVyJ1xuXG4vKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9wcm9wLXR5cGVzICovXG5jb25zdCBCdXR0b25JY29uID0gbWVtbyhmdW5jdGlvbiBCdXR0b25JY29uKHsgZWRnZSwgaWNvbiwgc2l6ZSwgc3BhY2luZyB9KSB7XG4gIGlmICghaWNvbikgcmV0dXJuIG51bGxcblxuICBjb25zdCByZWxhdGl2ZVNwYWNlID0gdHlwZW9mIHNwYWNpbmcgPT09ICdudW1iZXInID8gc3BhY2luZyA6IHNpemVcbiAgY29uc3QgZWRnZU1hcmdpbiA9IC1NYXRoLnJvdW5kKHJlbGF0aXZlU3BhY2UgKiAwLjI1KVxuICBjb25zdCBpbm5lck1hcmdpbiA9IE1hdGgucm91bmQoc2l6ZSAqIDAuNylcbiAgY29uc3QgbWFyZ2luTGVmdCA9IGVkZ2UgPT09ICdzdGFydCcgPyBlZGdlTWFyZ2luIDogaW5uZXJNYXJnaW5cbiAgY29uc3QgbWFyZ2luUmlnaHQgPSBlZGdlID09PSAnZW5kJyA/IGVkZ2VNYXJnaW4gOiBpbm5lck1hcmdpblxuXG4gIHJldHVybiA8SWNvbldyYXBwZXIgaWNvbj17aWNvbn0gc2l6ZT17c2l6ZX0gbWFyZ2luTGVmdD17bWFyZ2luTGVmdH0gbWFyZ2luUmlnaHQ9e21hcmdpblJpZ2h0fSAvPlxufSlcbi8qIGVzbGludC1lbmFibGUgcmVhY3QvcHJvcC10eXBlcyAqL1xuXG5leHBvcnQgY29uc3QgaW50ZXJuYWxTdHlsZXMgPSB7XG4gIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuICBmb250V2VpZ2h0OiA1MDAsXG4gIGRpc3BsYXk6ICdpbmxpbmUtZmxleCcsXG4gIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICBmbGV4V3JhcDogJ25vd3JhcCcsXG4gIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgdGV4dERlY29yYXRpb246ICdub25lJyxcbiAgdmVydGljYWxBbGlnbjogJ21pZGRsZScsXG4gIGJvcmRlcjogJ25vbmUnLFxuICBvdXRsaW5lOiAnbm9uZScsXG4gIHVzZXJTZWxlY3Q6ICdub25lJyxcbiAgY3Vyc29yOiAncG9pbnRlcicsXG4gIHdoaXRlU3BhY2U6ICdub3dyYXAnLFxuICBXZWJraXRGb250U21vb3RoaW5nOiAnYW50aWFsaWFzZWQnLFxuICBXZWJraXRBcHBlYXJhbmNlOiAnbm9uZScsXG4gIE1vekFwcGVhcmFuY2U6ICdub25lJyxcbiAgJyY6Oi1tb3otZm9jdXMtaW5uZXIgJzoge1xuICAgIGJvcmRlcjogMFxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBwc2V1ZG9TZWxlY3RvcnMgPSB7XG4gIF9hY3RpdmU6ICcmOm5vdChbZGlzYWJsZWRdKTphY3RpdmUsICY6bm90KFtkaXNhYmxlZF0pW2FyaWEtZXhwYW5kZWQ9XCJ0cnVlXCJdLCAmOm5vdChbZGlzYWJsZWRdKVtkYXRhLWFjdGl2ZV0nLFxuICBfZGlzYWJsZWQ6ICcmW2Rpc2FibGVkXScsXG4gIF9mb2N1czogJyY6bm90KFtkaXNhYmxlZF0pOmZvY3VzJyxcbiAgX2ZvY3VzQW5kQWN0aXZlOlxuICAgICcmOm5vdChbZGlzYWJsZWRdKTpmb2N1czphY3RpdmUsICY6bm90KFtkaXNhYmxlZF0pW2FyaWEtZXhwYW5kZWQ9XCJ0cnVlXCJdOmZvY3VzLCAmOm5vdChbZGlzYWJsZWRdKVtkYXRhLWFjdGl2ZV06Zm9jdXMnLFxuICBfaG92ZXI6ICcmOm5vdChbZGlzYWJsZWRdKTpob3Zlcidcbn1cblxuZXhwb3J0IGNvbnN0IGdldEljb25TaXplRm9yQnV0dG9uID0gaGVpZ2h0ID0+IHtcbiAgaWYgKGhlaWdodCA8PSAyOCkgcmV0dXJuIDEyXG4gIGlmIChoZWlnaHQgPD0gMzIpIHJldHVybiAxNFxuICBpZiAoaGVpZ2h0IDw9IDQwKSByZXR1cm4gMTZcbiAgaWYgKGhlaWdodCA8PSA0OCkgcmV0dXJuIDE4XG4gIHJldHVybiAyMFxufVxuXG5jb25zdCBCdXR0b24gPSBtZW1vKFxuICBmb3J3YXJkUmVmKGZ1bmN0aW9uIEJ1dHRvbihwcm9wcywgcmVmKSB7XG4gICAgY29uc3Qge1xuICAgICAgYXBwZWFyYW5jZSA9ICdkZWZhdWx0JyxcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY29sb3IsXG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGljb25BZnRlcixcbiAgICAgIGljb25CZWZvcmUsXG4gICAgICBpbnRlbnQgPSAnbm9uZScsXG4gICAgICBpcyA9ICdidXR0b24nLFxuICAgICAgaXNBY3RpdmUgPSBmYWxzZSxcbiAgICAgIGlzTG9hZGluZyxcbiAgICAgIC4uLnJlc3RQcm9wc1xuICAgIH0gPSBwcm9wc1xuXG4gICAgY29uc3QgeyBjbGFzc05hbWU6IHRoZW1lZENsYXNzTmFtZSwgLi4uYm94UHJvcHMgfSA9IHVzZVN0eWxlQ29uZmlnKFxuICAgICAgJ0J1dHRvbicsXG4gICAgICB7IGFwcGVhcmFuY2UsIGNvbG9yLCBpbnRlbnQsIHNpemU6IHJlc3RQcm9wcy5zaXplIHx8ICdtZWRpdW0nIH0sXG4gICAgICBwc2V1ZG9TZWxlY3RvcnMsXG4gICAgICBpbnRlcm5hbFN0eWxlc1xuICAgIClcblxuICAgIGNvbnN0IGhlaWdodCA9IHJlc3RQcm9wcy5oZWlnaHQgfHwgYm94UHJvcHMuaGVpZ2h0XG4gICAgLy8gS2VlcCBiYWNrd2FyZHMgY29tcGF0IGZvbnQgc2l6aW5nIGlmIGFuIGV4cGxpY2l0IGhlaWdodCB3YXMgcGFzc2VkIGluLlxuICAgIGNvbnN0IHRleHRQcm9wcyA9ICFyZXN0UHJvcHMuc2l6ZSAmJiByZXN0UHJvcHMuaGVpZ2h0ID8gZ2V0VGV4dFByb3BzRm9yQ29udHJvbEhlaWdodChyZXN0UHJvcHMuaGVpZ2h0KSA6IHt9XG4gICAgY29uc3QgaWNvblNpemUgPSBnZXRJY29uU2l6ZUZvckJ1dHRvbihoZWlnaHQpXG5cbiAgICByZXR1cm4gKFxuICAgICAgPEJveFxuICAgICAgICBpcz17aXN9XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgICBjbGFzc05hbWU9e2N4KHRoZW1lZENsYXNzTmFtZSwgY2xhc3NOYW1lKX1cbiAgICAgICAgZGF0YS1hY3RpdmU9e2lzQWN0aXZlIHx8IHVuZGVmaW5lZH1cbiAgICAgICAgey4uLmJveFByb3BzfVxuICAgICAgICB7Li4ucmVzdFByb3BzfVxuICAgICAgICB7Li4udGV4dFByb3BzfVxuICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWQgfHwgaXNMb2FkaW5nfVxuICAgICAgPlxuICAgICAgICB7aXNMb2FkaW5nICYmIChcbiAgICAgICAgICA8U3Bpbm5lclxuICAgICAgICAgICAgbWFyZ2luTGVmdD17LU1hdGgucm91bmQoaGVpZ2h0IC8gOCl9XG4gICAgICAgICAgICBtYXJnaW5SaWdodD17TWF0aC5yb3VuZChoZWlnaHQgLyA0KX1cbiAgICAgICAgICAgIHNpemU9e01hdGgucm91bmQoaGVpZ2h0IC8gMil9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAgPEJ1dHRvbkljb24gaWNvbj17aWNvbkJlZm9yZX0gc2l6ZT17aWNvblNpemV9IHNwYWNpbmc9e3Jlc3RQcm9wcy5wYWRkaW5nTGVmdH0gZWRnZT1cInN0YXJ0XCIgLz5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8QnV0dG9uSWNvbiBpY29uPXtpY29uQWZ0ZXJ9IHNpemU9e2ljb25TaXplfSBzcGFjaW5nPXtyZXN0UHJvcHMucGFkZGluZ1JpZ2h0fSBlZGdlPVwiZW5kXCIgLz5cbiAgICAgIDwvQm94PlxuICAgIClcbiAgfSlcbilcblxuQnV0dG9uLnByb3BUeXBlcyA9IHtcbiAgLyoqXG4gICAqIENvbXBvc2VzIHRoZSBkaW1lbnNpb25zIHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLmRpbWVuc2lvbnMucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBDb21wb3NlcyB0aGUgc3BhY2luZyBzcGVjIGZyb20gdGhlIEJveCBwcmltaXRpdmUuXG4gICAqL1xuICAuLi5zcGFjaW5nLnByb3BUeXBlcyxcblxuICAvKipcbiAgICogQ29tcG9zZXMgdGhlIHBvc2l0aW9uIHNwZWMgZnJvbSB0aGUgQm94IHByaW1pdGl2ZS5cbiAgICovXG4gIC4uLnBvc2l0aW9uLnByb3BUeXBlcyxcblxuICAvKipcbiAgICogQ29tcG9zZXMgdGhlIGxheW91dCBzcGVjIGZyb20gdGhlIEJveCBwcmltaXRpdmUuXG4gICAqL1xuICAuLi5sYXlvdXQucHJvcFR5cGVzLFxuXG4gIC8qKlxuICAgKiBUaGUgaW50ZW50IG9mIHRoZSBidXR0b24uXG4gICAqL1xuICBpbnRlbnQ6IFByb3BUeXBlcy5zdHJpbmcsXG5cbiAgLyoqXG4gICAqIFRoZSBhcHBlYXJhbmNlIG9mIHRoZSBidXR0b24uXG4gICAqL1xuICBhcHBlYXJhbmNlOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gIC8qKlxuICAgKiBUaGUgc2l6ZSBvZiB0aGUgYnV0dG9uXG4gICAqL1xuICBzaXplOiBQcm9wVHlwZXMub25lT2YoWydzbWFsbCcsICdtZWRpdW0nLCAnbGFyZ2UnXSksXG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1ZSwgc2hvdyBhIGxvYWRpbmcgc3Bpbm5lciBiZWZvcmUgdGhlIGNoaWxkcmVuLlxuICAgKiBUaGlzIGFsc28gZGlzYWJsZXMgdGhlIGJ1dHRvbi5cbiAgICovXG4gIGlzTG9hZGluZzogUHJvcFR5cGVzLmJvb2wsXG5cbiAgLyoqXG4gICAqIEZvcmNlZnVsbHkgc2V0IHRoZSBhY3RpdmUgc3RhdGUgb2YgYSBidXR0b24uXG4gICAqIFVzZWZ1bCBpbiBjb25qdW5jdGlvbiB3aXRoIGEgUG9wb3Zlci5cbiAgICovXG4gIGlzQWN0aXZlOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvKipcbiAgICogU2V0cyBhbiBpY29uIGJlZm9yZSB0aGUgdGV4dC4gQ2FuIGJlIGFueSBpY29uIGZyb20gRXZlcmdyZWVuIG9yIGEgY3VzdG9tIGVsZW1lbnQuXG4gICAqL1xuICBpY29uQmVmb3JlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZWxlbWVudFR5cGUsIFByb3BUeXBlcy5lbGVtZW50XSksXG5cbiAgLyoqXG4gICAqIFNldHMgYW4gaWNvbiBhZnRlciB0aGUgdGV4dC4gQ2FuIGJlIGFueSBpY29uIGZyb20gRXZlcmdyZWVuIG9yIGEgY3VzdG9tIGVsZW1lbnQuXG4gICAqL1xuICBpY29uQWZ0ZXI6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5lbGVtZW50VHlwZSwgUHJvcFR5cGVzLmVsZW1lbnRdKSxcblxuICAvKipcbiAgICogV2hlbiB0cnVlLCB0aGUgYnV0dG9uIGlzIGRpc2FibGVkLlxuICAgKiBpc0xvYWRpbmcgYWxzbyBzZXRzIHRoZSBidXR0b24gdG8gZGlzYWJsZWQuXG4gICAqL1xuICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG5cbiAgLyoqXG4gICAqIENsYXNzIG5hbWUgcGFzc2VkIHRvIHRoZSBidXR0b24uXG4gICAqIE9ubHkgdXNlIGlmIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZy5cbiAgICovXG4gIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZ1xufVxuXG5leHBvcnQgZGVmYXVsdCBCdXR0b25cbiJdfQ==